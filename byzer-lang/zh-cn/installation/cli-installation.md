# Byzer-lang 命令行安装与配置

我们提供了命令行执行脚本的能力，方便用户自助实现更多自动化能力。下面介绍其安装和使用。

### 安装流程

#### 一、设置 Byzer-lang 环境

下面将介绍 Byzer-lang 命令行中环境变量的含义和安装步骤。

1. 环境变量

使用前，需要设置两个环境变量：`MLSQL_LANG_HOME` 和 `PATH`。

- **MLSQL_LANG_HOME**：Byzer-lang 命令行所在的目录，设置 `PATH` 时，可以使用该变量以方便设置。

- **PATH**：路径列表，用于搜索可执行文件。执行某个可执行文件时，如未能在当前路径下找到该文件，则将会依次寻找 `PATH` 中的每一个路径，直至找到可执行文件为止。

  > Byzer-lang 命令行的执行命令 (byzer) 位于安装路径下的 bin 目录中，因此该目录也应被添加到 PATH 变量中。

2. 下载 byzer-lang 命令行。

下载 byzer-lang 命令行程序包，地址如下：

- [Mac 版](https://download.byzer.org/byzer/2.2.1/byzer-lang-darwin-amd64-3.0-2.2.1.tar.gz)
- [Linux 版](https://download.byzer.org/byzer/2.2.1/byzer-lang-linux-amd64-3.0-2.2.1.tar.gz)

3. 目录结构

本示例以 mac 环境为例，下载 [适配 mac 环境的压缩包](https://download.byzer.org/byzer/2.2.1/byzer-lang-darwin-amd64-3.0-2.2.1.tar.gz) 后，对 tar 包进行解压缩，内部的目录结构如下：

```
|-- bin
|-- jdk8
|-- libs
|-- logs
|-- main
|-- plugin
`-- spark
```

4. 引入环境变量

接下来，需要把解压后的文件放置到固定的目录，并配置环境变量，其中 `MLSQL_LANG_HOME` 为包含 `bin` 目录的上一层目录，如下所示：

```
export MLSQL_LANG_HOME=/opt/byzer-lang-darwin-amd64-3.0-2.2.1
export PATH=${MLSQL_LANG_HOME}/bin:$PATH
```

> **注意** ：该示例将程序包放在 /opt 目录下，用户可以指定其他方便使用的位置。

5. 查看使用手册

修改完环境变量后，可以通过 `version` 验证是否安装成功和当前 byzer 命令行版本，具体命令如下：

```shell
byzer --version
```

如果正常配置，将显示下面的日志：

```
mlsql lang cli version 0.0.4-dev (2021-09-29 51f8d6a)
```

#### 二、执行 Byzer-lang 脚本

##### 使用示例

下面我们来看一个完整的例子，我们创建一个 `hello.mlsql` 的脚本文件，内容如下：

```
!hdfs -ls /tmp;
```

使用一行命令，执行 byzer-lang 脚本：

```shell
byzer run ./hello.mlsql
```

注意，如果是 Mac 用户，会提示 App 的安全问题，需要通过 系统偏好设置 - 安全性与隐私 - 允许从以下位置下载 App ，选择仍然允许。


然后我们就可以通过命令行执行并查看效果，执行日志如下：
```
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|fileSystem                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
|Found 1 items
-rw-------   1 root wheel         36 2021-12-14 10:26 /tmp/fseventsd-uuid fseventsd-uuid
Found 1 items
-rwxrwxrwx   1 root wheel          0 2021-12-14 10:36 /tmp/com.symantec.avscandaemon.ME com.symantec.avscandaemon.ME
Found 1 items
-rw-------   1 root wheel          4 2021-12-14 10:26 /tmp/com.broadcom.mes.systemextension.launches com.broadcom.mes.systemextension.launches
Found 1 items
drwxr-xr-x   - jiachuan.zhu wheel        128 2021-12-14 10:28 /tmp/com.google.Keystone com.google.Keystone
Found 1 items
drwxr-xr-x   - root         wheel         64 2021-12-14 10:26 /tmp/powerlog powerlog
Found 1 items
drwx------   - jiachuan.zhu wheel         96 2021-12-14 10:27 /tmp/com.apple.launchd.H49bLnfY3x com.apple.launchd.H49bLnfY3x
Found 1 items
drwx------   - root         wheel        160 2021-12-16 10:30 /tmp/AVScanFrCP AVScanFrCP
Found 1 items
-rwxrwxrwx   1 root         wheel          0 2021-12-14 10:26 /tmp/SymUIAgents.MES SymUIAgents.MES
Found 1 items
-rw-------   1 root         wheel          4 2021-12-14 10:26 /tmp/com.symantec.daemon.launches com.symantec.daemon.launches
Found 1 items
-rwxr-xr-x   1 jiachuan.zhu wheel          0 2021-12-15 18:04 /tmp/thorrustsdk_702 thorrustsdk_702
Found 1 items
-rw-rw-rw-   1 root         wheel          0 2021-12-14 10:26 /tmp/registry.lock registry.lock
Found 1 items
-rwxrwxrwx   1 root         wheel          0 2021-12-14 10:26 /tmp/SymMCLMMES SymMCLMMES
|
+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
```

> 恭喜，你已经完成 Byzer 命令行的安装和使用。